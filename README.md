This is just some experimental work, just pushing this to GitHub to get help on a performance issue.